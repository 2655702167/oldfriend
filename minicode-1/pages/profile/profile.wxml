<!-- profile.wxml -->
<view style="height: 60rpx;"></view>
<view style="height: 140rpx; font-size: {{fontSizes.title}};display: flex;justify-content: center;align-items: center;background-color: #4A90E2;">个人中心</view>
<scroll-view class="profile-container" scroll-y="true" enhanced="true" show-scrollbar="false">
  <!-- 用户信息卡片 -->
  <view class="user-card">
    <view class="user-avatar">
      <image src="{{userInfo.avatarUrl || '/images/profile/default-avatar.png'}}" class="avatar-img"></image>
    </view>
    
    <!-- 已绑定状态：显示手机号 -->
    <view class="user-info" wx:if="{{userInfo.phoneNumber}}">
      <text class="user-name">{{userInfo.phoneNumber}}</text>
      <text class="user-phone">欢迎回来</text>
    </view>

    <!-- 未绑定状态：显示欢迎语 -->
    <view class="user-info" wx:else>
      <text class="user-name">欢迎使用</text>
      <text class="user-phone">登录体验更多功能</text>
    </view>
  </view>

  <!-- 登录/绑定区域 (仿滴滴风格) -->
  <view class="login-section" wx:if="{{!userInfo.phoneNumber}}">
    <!-- 微信一键绑定按钮 -->
    <button class="wechat-login-btn" open-type="getPhoneNumber" bindgetphonenumber="onGetPhoneNumber">
      本机号码一键绑定
    </button>
    
    <!-- 手动输入链接 -->
    <view class="manual-login-link" bindtap="showPhoneInput">
      输入手机号码绑定/注册
    </view>
  </view>

  <!-- 功能列表 -->
  <view class="function-list">
    <!-- 第一组功能 -->
    <view class="list-group">
      <view class="list-item" bindtap="navigateToMyInfo">
        <text class="item-text" style="font-size: {{fontSizes.content}};">我的信息</text>
        <image src="/images/profile/arrow-right.png" class="arrow-icon"></image>
      </view>
      
      <view class="list-item" bindtap="navigateToEmergencyContact">
        <text class="item-text" style="font-size: {{fontSizes.content}};">紧急联系人</text>
        <image src="/images/profile/arrow-right.png" class="arrow-icon"></image>
      </view>
      
      <view class="list-item" bindtap="navigateToCommonAddress">
        <text class="item-text" style="font-size: {{fontSizes.content}};">常用地址</text>
        <image src="/images/profile/arrow-right.png" class="arrow-icon"></image>
      </view>
    </view>

    <!-- 第二组功能 -->
    <view class="list-group">
      <view class="list-item" bindtap="navigateToPaymentRecord">
        <text class="item-text" style="font-size: {{fontSizes.content}};">缴费记录</text>
        <image src="/images/profile/arrow-right.png" class="arrow-icon"></image>
      </view>
      
      <view class="list-item" bindtap="navigateToRegistrationRecord">
        <text class="item-text" style="font-size: {{fontSizes.content}};">挂号记录</text>
        <image src="/images/profile/arrow-right.png" class="arrow-icon"></image>
      </view>
    </view>

    <!-- 第三组功能 -->
    <view class="list-group">
      <view class="list-item" bindtap="navigateToVoiceSettings">
        <text class="item-text" style="font-size: {{fontSizes.content}};">语音设置</text>
        <image src="/images/profile/arrow-right.png" class="arrow-icon"></image>
      </view>
      
      <view class="list-item" bindtap="navigateToDialectSettings">
        <text class="item-text" style="font-size: {{fontSizes.content}};">方言设置</text>
        <image src="/images/profile/arrow-right.png" class="arrow-icon"></image>
      </view>
    </view>

    <!-- 重置数据按钮 -->
    <view class="list-group" style="margin-top: 30rpx;" wx:if="{{userInfo.nickName || userInfo.phoneNumber}}">
      <view class="list-item" bindtap="handleLogout" style="justify-content: center;">
        <text class="item-text" style="color: #ff4d4f; font-weight: bold; font-size: {{fontSizes.content}};">重置用户信息</text>
      </view>
    </view>
  </view>
  
  <!-- 底部占位，防止被tabbar遮挡 -->
  <view style="height: 150rpx;"></view>
</scroll-view>